{"version":3,"file":"index.cjs.js","sources":["../../database/interfaces.ts","../../database/fromRef.ts","../../database/utils.ts","../../database/object/index.ts","../../database/list/index.ts","../../database/list/audit-trail.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _a;\nimport { onChildAdded, onChildChanged, onChildMoved, onChildRemoved, onValue } from 'firebase/database';\nexport var ListenEvent;\n(function (ListenEvent) {\n    ListenEvent[\"added\"] = \"child_added\";\n    ListenEvent[\"removed\"] = \"child_removed\";\n    ListenEvent[\"changed\"] = \"child_changed\";\n    ListenEvent[\"moved\"] = \"child_moved\";\n    ListenEvent[\"value\"] = \"value\";\n})(ListenEvent || (ListenEvent = {}));\nexport var ListenerMethods = Object.freeze((_a = {},\n    _a[ListenEvent.added] = onChildAdded,\n    _a[ListenEvent.removed] = onChildRemoved,\n    _a[ListenEvent.changed] = onChildChanged,\n    _a[ListenEvent.moved] = onChildMoved,\n    _a[ListenEvent.value] = onValue,\n    _a));\n","/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Observable } from 'rxjs';\nimport { delay } from 'rxjs/operators';\nimport { ListenerMethods } from './interfaces';\nimport { off } from 'firebase/database';\n/**\n * Create an observable from a Database Reference or Database Query.\n * @param ref Database Reference\n * @param event Listen event type ('value', 'added', 'changed', 'removed', 'moved')\n */\nexport function fromRef(ref, event) {\n    return new Observable(function (subscriber) {\n        var fn = ListenerMethods[event](ref, function (snapshot, prevKey) {\n            subscriber.next({ snapshot: snapshot, prevKey: prevKey, event: event });\n        }, subscriber.error.bind(subscriber));\n        return {\n            unsubscribe: function () {\n                off(ref, event, fn);\n            }\n        };\n    }).pipe(\n    // Ensures subscribe on observable is async. This handles\n    // a quirk in the SDK where on/once callbacks can happen\n    // synchronously.\n    delay(0));\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ListenEvent } from './interfaces';\n/**\n * Check the length of the provided array. If it is empty return an array\n * that is populated with all the Realtime Database child events.\n * @param events\n */\nexport function validateEventsArray(events) {\n    if (events == null || events.length === 0) {\n        events = [\n            ListenEvent.added,\n            ListenEvent.removed,\n            ListenEvent.changed,\n            ListenEvent.moved\n        ];\n    }\n    return events;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { __assign } from \"tslib\";\nimport { ListenEvent } from '../interfaces';\nimport { fromRef } from '../fromRef';\nimport { map } from 'rxjs/operators';\n/**\n * Get the snapshot changes of an object\n * @param query\n */\nexport function object(query) {\n    return fromRef(query, ListenEvent.value);\n}\n/**\n * Get an array of object values, optionally with a mapped key\n * @param query object ref or query\n * @param keyField map the object key to a specific field\n */\nexport function objectVal(query, options) {\n    if (options === void 0) { options = {}; }\n    return fromRef(query, ListenEvent.value).pipe(map(function (change) { return changeToData(change, options); }));\n}\nexport function changeToData(change, options) {\n    var _a;\n    if (options === void 0) { options = {}; }\n    var val = change.snapshot.val();\n    // match the behavior of the JS SDK when the snapshot doesn't exist\n    if (!change.snapshot.exists()) {\n        return val;\n    }\n    // val can be a primitive type\n    if (typeof val !== 'object') {\n        return val;\n    }\n    return __assign(__assign({}, val), (options.keyField ? (_a = {}, _a[options.keyField] = change.snapshot.key, _a) : null));\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { __spreadArray } from \"tslib\";\nimport { ListenEvent } from '../interfaces';\nimport { of, merge, from } from 'rxjs';\nimport { validateEventsArray } from '../utils';\nimport { fromRef } from '../fromRef';\nimport { switchMap, scan, distinctUntilChanged, map } from 'rxjs/operators';\nimport { changeToData } from '../object';\nimport { get as databaseGet } from 'firebase/database';\nexport function stateChanges(query, options) {\n    if (options === void 0) { options = {}; }\n    var events = validateEventsArray(options.events);\n    var childEvent$ = events.map(function (event) { return fromRef(query, event); });\n    return merge.apply(void 0, childEvent$);\n}\nfunction get(query) {\n    return from(databaseGet(query)).pipe(map(function (snapshot) {\n        var event = ListenEvent.value;\n        return { snapshot: snapshot, prevKey: null, event: event };\n    }));\n}\nexport function list(query, options) {\n    if (options === void 0) { options = {}; }\n    var events = validateEventsArray(options.events);\n    return get(query).pipe(switchMap(function (change) {\n        if (!change.snapshot.exists()) {\n            return of([]);\n        }\n        var childEvent$ = [of(change)];\n        events.forEach(function (event) {\n            childEvent$.push(fromRef(query, event));\n        });\n        return merge.apply(void 0, childEvent$).pipe(scan(buildView, []));\n    }), distinctUntilChanged());\n}\n/**\n * Get an object mapped to its value, and optionally its key\n * @param query object ref or query\n * @param keyField map the object key to a specific field\n */\nexport function listVal(query, options) {\n    if (options === void 0) { options = {}; }\n    return list(query).pipe(map(function (arr) {\n        return arr.map(function (change) { return changeToData(change, options); });\n    }));\n}\nfunction positionFor(changes, key) {\n    var len = changes.length;\n    for (var i = 0; i < len; i++) {\n        if (changes[i].snapshot.key === key) {\n            return i;\n        }\n    }\n    return -1;\n}\nfunction positionAfter(changes, prevKey) {\n    if (prevKey == null) {\n        return 0;\n    }\n    else {\n        var i = positionFor(changes, prevKey);\n        if (i === -1) {\n            return changes.length;\n        }\n        else {\n            return i + 1;\n        }\n    }\n}\nfunction buildView(current, change) {\n    var snapshot = change.snapshot, prevKey = change.prevKey, event = change.event;\n    var key = snapshot.key;\n    var currentKeyPosition = positionFor(current, key);\n    var afterPreviousKeyPosition = positionAfter(current, prevKey || undefined);\n    switch (event) {\n        case ListenEvent.value:\n            if (change.snapshot && change.snapshot.exists()) {\n                var prevKey_1 = null;\n                change.snapshot.forEach(function (snapshot) {\n                    var action = {\n                        snapshot: snapshot,\n                        event: ListenEvent.value,\n                        prevKey: prevKey_1\n                    };\n                    prevKey_1 = snapshot.key;\n                    current = __spreadArray(__spreadArray([], current), [action]);\n                    return false;\n                });\n            }\n            return current;\n        case ListenEvent.added:\n            if (currentKeyPosition > -1) {\n                // check that the previouskey is what we expect, else reorder\n                var previous = current[currentKeyPosition - 1];\n                if (((previous && previous.snapshot.key) || null) !== prevKey) {\n                    current = current.filter(function (x) { return x.snapshot.key !== snapshot.key; });\n                    current.splice(afterPreviousKeyPosition, 0, change);\n                }\n            }\n            else if (prevKey == null) {\n                return __spreadArray([change], current);\n            }\n            else {\n                current = current.slice();\n                current.splice(afterPreviousKeyPosition, 0, change);\n            }\n            return current;\n        case ListenEvent.removed:\n            return current.filter(function (x) { return x.snapshot.key !== snapshot.key; });\n        case ListenEvent.changed:\n            return current.map(function (x) { return (x.snapshot.key === key ? change : x); });\n        case ListenEvent.moved:\n            if (currentKeyPosition > -1) {\n                var data = current.splice(currentKeyPosition, 1)[0];\n                current = current.slice();\n                current.splice(afterPreviousKeyPosition, 0, data);\n                return current;\n            }\n            return current;\n        // default will also remove null results\n        default:\n            return current;\n    }\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { __spreadArray } from \"tslib\";\nimport { ListenEvent } from '../interfaces';\nimport { fromRef } from '../fromRef';\nimport { map, withLatestFrom, scan, skipWhile } from 'rxjs/operators';\nimport { stateChanges } from './index';\nexport function auditTrail(query, options) {\n    if (options === void 0) { options = {}; }\n    var auditTrail$ = stateChanges(query, options).pipe(scan(function (current, changes) { return __spreadArray(__spreadArray([], current), [changes]); }, []));\n    return waitForLoaded(query, auditTrail$);\n}\nfunction loadedData(query) {\n    // Create an observable of loaded values to retrieve the\n    // known dataset. This will allow us to know what key to\n    // emit the \"whole\" array at when listening for child events.\n    return fromRef(query, ListenEvent.value).pipe(map(function (data) {\n        // Store the last key in the data set\n        var lastKeyToLoad;\n        // Loop through loaded dataset to find the last key\n        data.snapshot.forEach(function (child) {\n            lastKeyToLoad = child.key;\n            return false;\n        });\n        // return data set and the current last key loaded\n        return { data: data, lastKeyToLoad: lastKeyToLoad };\n    }));\n}\nfunction waitForLoaded(query, snap$) {\n    var loaded$ = loadedData(query);\n    return loaded$.pipe(withLatestFrom(snap$), \n    // Get the latest values from the \"loaded\" and \"child\" datasets\n    // We can use both datasets to form an array of the latest values.\n    map(function (_a) {\n        var loaded = _a[0], changes = _a[1];\n        // Store the last key in the data set\n        var lastKeyToLoad = loaded.lastKeyToLoad;\n        // Store all child keys loaded at this point\n        var loadedKeys = changes.map(function (change) { return change.snapshot.key; });\n        return { changes: changes, lastKeyToLoad: lastKeyToLoad, loadedKeys: loadedKeys };\n    }), \n    // This is the magical part, only emit when the last load key\n    // in the dataset has been loaded by a child event. At this point\n    // we can assume the dataset is \"whole\".\n    skipWhile(function (meta) {\n        return meta.loadedKeys.indexOf(meta.lastKeyToLoad) === -1;\n    }), \n    // Pluck off the meta data because the user only cares\n    // to iterate through the snapshots\n    map(function (meta) { return meta.changes; }));\n}\n"],"names":["ListenEvent","onChildAdded","onChildRemoved","onChildChanged","onChildMoved","onValue","Observable","off","delay","map","__assign","merge","from","databaseGet","switchMap","of","scan","distinctUntilChanged","__spreadArray","withLatestFrom","skipWhile"],"mappings":"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"}